pipeline {
    agent any
    
    stages{
        
         stage('Stage 1: Cloning Repo') {
            steps{
                git credentialsId: 'github', url: 'https://github.com/Task0209/chillapp.git'
            }
        }
        
        
         stage ('Stage 1: Cleaning up the apps in K8s Cluster'){
             steps {
                 script {
                      withKubeConfig(credentialsId: 'kkk', serverUrl: 'https://192.168.0.50:6443') {
                                 sh 'curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"'  
                                 sh 'chmod u+x ./kubectl'
                                  sh './kubectl delete -f deploy.yaml'
                                  sh './kubectl delete -f service.yaml'
                                 }
                  }
             }
           }
    }
}
